language: node_js
node_js:
  - "12"
cache:
  npm: false
install:
  - npm install
  - npm run lerna bootstrap
script:
  - npm run lerna run --scope deskpro-component-library test:prod
  #- npm run lerna run --scope deskpro-admin-frontend test
  - npm run lerna run --scope deskpro-component-library build-storybook
  - npm run lerna run --scope deskpro-admin-frontend build
  - .travis/prep-site.sh
deploy:
  - provider: pages
    skip_cleanup: true
    github_token: $GH_TOKEN
    keep-history: true
    local-dir: ./gh-pages
    on:
      branch: master
